<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.zywl.app.defaultx.mapper.UserVipMapper">


    <insert id="insert" parameterType="UserVip" useGeneratedKeys="true" keyProperty="id" keyColumn="id">
        insert into t_user_vip
        (user_id,
         vip_level,
         recharge_amount,
         rank,
         create_time,
         update_time)
        values (#{userId},
                #{vipLevel},
                #{rechargeAmount},
                #{rank},
                #{createTime},
                #{updateTime})
    </insert>
    <update id="updateUserVip" parameterType="UserVip">
        update t_user_vip
        <set>
            <if test="vipLevel!=null">
                vip_level = #{vipLevel},
            </if>
            <if test="rechargeAmount!=null">
                recharge_amount = #{rechargeAmount},
            </if>
            <if test="rank!=null">
                rank = #{rank},
            </if>
        </set>
        where id = #{id}
    </update>


    <select id="findRechargeAmountByUserId" resultType="UserVip">
        select *
        from t_user_vip
        where user_id = #{userId}
    </select>
    <select id="findTopByVip" resultType="VipTopVo">
        SELECT
            t1.id AS userId,
            t1.`name` AS userName,
            t1.head_image_url AS userHeadImg,
            t2.vip_level as num,
            t1.user_no AS userNo,
            t1.vip1 as vipLv
        FROM
            t_user t1,t_user_vip t2
        WHERE
            t1.id=t2.user_id   ORDER BY t2.vip_level desc,t2.recharge_amount desc limit 0, 30;
    </select>



	<select id="findOne" resultType="UserVip">
	    select * from t_user_vip where id = #{id}
	</select>
    <select id="findUserVipByUserId" resultType="UserVip">
	    select * from t_user_vip where user_id = #{userId}
	</select>

	<select id="findAll" resultType="UserVip">
	    select * from t_user_vip
	</select>

	<select id="countByConditions" resultType="Long">
		select count(1) from t_user_vip
	</select>
    <select id="findCountByLv" resultType="Long">
        select count(1) from t_user_vip
        where  vip_level>=#{lv}
    </select>

</mapper>