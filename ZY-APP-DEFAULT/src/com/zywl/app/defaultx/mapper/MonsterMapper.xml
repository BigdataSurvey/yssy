<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.zywl.app.defaultx.mapper.MonsterMapper">

    <insert id="insert" parameterType="Monster" useGeneratedKeys="true" keyProperty="id" keyColumn="id">
        insert into t_monster
        (
            `monster_type`,
            `user_id`,
            `die_status`,
            `curr_blood`,
            `profit`,
            `bet_amount`,
            `create_time`,
            `update_time`
        )
        values
            (
                #{monsterType},
                #{userId},
                #{dieStatus},
                #{currBlood},
                #{profit},
                #{betAmount},
                #{createTime},
                #{updateTime}
            )
    </insert>

    <update id="update" parameterType="Monster">
        update t_monster
        <set >
            <if test="dieStatus != null">
                die_status= #{dieStatus},
            </if>
            <if test="currBlood != null">
                curr_blood= #{currBlood},
            </if>
            <if test="profit != null">
                profit= #{profit},
            </if>
            <if test="betAmount != null">
                bet_amount= #{betAmount},
            </if>
            <if test="createTime != null">
                create_time= #{createTime},
            </if>
            <if test="updateTime != null">
                update_time= #{updateTime}
            </if>
        </set>
        where  monster_type= #{monsterType} and user_id = #{userId}
    </update>

    <update id="updateMonsterByUserId" parameterType="Monster">
        update t_monster
        <set >
            <if test="die_status != null">
                die_status= #{dieStatus},
            </if>
            <if test="currBlood != null">
                curr_blood= #{currBlood},
            </if>
            <if test="profit != null">
                profit= #{profit},
            </if>
            <if test="betAmount != null">
                bet_amount= #{betAmount},
            </if>
            <if test="createTime != null">
                create_time= #{createTime},
            </if>
            <if test="updateTime != null">
                update_time= #{updateTime}
            </if>
        </set>
        where  monster_type= #{monsterType} and user_id = #{UserId}
    </update>


    <select id="findMonsterByStatus" resultType="Monster">
        select * from t_monster where die_status = #{dieStatus} and monster_type = #{monsterType} order by curr_blood ASC
    </select>
    <select id="findMonsterInitStatus" resultType="Monster">
        select monster_type,MIN(curr_blood) as curr_blood from t_monster where die_status =#{dieStatus} group by monster_type
    </select>
    <update id="batchUpdateRecord" parameterType="java.util.List">
        <foreach collection="list" item="item" index="index" open="" close="" separator=";">
            update t_monster
            <set>
                die_status=#{item.dieStatus},curr_blood=#{item.currBlood},profit=#{item.profit},bet_amount=#{item.betAmount},create_time=#{item.createTime},update_time=#{item.updateTime}
            </set>
            where monster_type= #{item.monsterType} and user_id = #{item.userId}
        </foreach>
    </update>







</mapper>